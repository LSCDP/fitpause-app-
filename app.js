// √úbersetzungen f√ºr die Seite
const translations = {
  de: {
    cookie_text: "Wir verwenden Cookies, um deine Erfahrung zu verbessern. Durch die Nutzung unserer Website stimmst du unserer Cookie-Richtlinie zu.",
    accept_cookies: "Akzeptieren",
    nav_features: "Features",
    nav_pricing: "Preise",
    nav_how: "So funktioniert's",
    hero_title: "Personalisierte Ern√§hrung war noch nie so einfach",
    hero_subtitle: "KI-gest√ºtzte Wochenpl√§ne & Rezepte f√ºr jeden Geschmack",
    feature_1: "‚ú® Individuell angepasst an deine Bed√ºrfnisse",
    feature_2: "ü•ó Gesunde Rezepte f√ºr jeden Tag",
    feature_3: "üõí Automatische Einkaufslisten",
    feature_4: "‚è∞ Spart Zeit und Aufwand",
    get_started: "Jetzt kostenlos starten",
    example_title: "So k√∂nnte dein Wochenplan aussehen",
    allergy_gluten: "Gluten",
    allergy_lactose: "Laktose",
    add_custom_allergy: "Hinzuf√ºgen",
    meal_mon: "Gem√ºsepfanne", mon:"Montag",
    meal_tue: "Quinoa-Salat mit Avocado", tue:"Dienstag",
    meal_wed: "Lachs mit S√º√ükartoffeln", wed:"Mittwoch",
    meal_thu: "H√§hnchen-Curry mit Reis", thu:"Donnerstag",
    meal_fri: "Pasta mit Gem√ºse", fri:"Freitag",
    meal_sat: "Veggie-Burger", sat:"Samstag",
    meal_sun: "Asiatisches Stir-Fry", sun:"Sonntag",
    trust_gdpr: "DSGVO-konform",
    trust_email: "Sichere E-Mails",
    trust_ai: "KI-gest√ºtzt",
    trust_mobile: "Mobil optimiert",
    custom_allergy_placeholder: "Eigene Allergie hinzuf√ºgen"
  },
  en: {
    cookie_text: "We use cookies to improve your experience. By using our website, you agree to our cookie policy.",
    accept_cookies: "Accept",
    nav_features: "Features",
    nav_pricing: "Pricing",
    nav_how: "How it works",
    hero_title: "Personalized nutrition has never been easier",
    hero_subtitle: "AI-powered weekly plans & recipes for every taste",
    feature_1: "‚ú® Individually tailored to your needs",
    feature_2: "ü•ó Healthy recipes for every day",
    feature_3: "üõí Automatic shopping lists",
    feature_4: "‚è∞ Saves time and effort",
    get_started: "Start for free now",
    example_title: "This could be your weekly plan",
    allergy_gluten: "Gluten",
    allergy_lactose: "Lactose",
    add_custom_allergy: "Add",
    meal_mon: "Vegetable Stir-Fry", mon:"Monday",
    meal_tue: "Quinoa Salad with Avocado", tue:"Tuesday",
    meal_wed: "Salmon with Sweet Potatoes", wed:"Wednesday",
    meal_thu: "Chicken Curry with Rice", thu:"Thursday",
    meal_fri: "Pasta with Vegetables", fri:"Friday",
    meal_sat: "Veggie Burger", sat:"Saturday",
    meal_sun: "Asian Stir-Fry", sun:"Sunday",
    trust_gdpr: "GDPR-compliant",
    trust_email: "Secure emails",
    trust_ai: "AI-powered",
    trust_mobile: "Mobile-optimized",
    custom_allergy_placeholder: "Add your own allergy"
  },
  es: {
    cookie_text: "Utilizamos cookies para mejorar tu experiencia. Al usar nuestro sitio web, aceptas nuestra pol√≠tica de cookies.",
    accept_cookies: "Aceptar",
    nav_features: "Caracter√≠sticas",
    nav_pricing: "Precios",
    nav_how: "C√≥mo funciona",
    hero_title: "La nutrici√≥n personalizada nunca fue tan f√°cil",
    hero_subtitle: "Planes y recetas semanales con IA para todos los gustos",
    feature_1: "‚ú® Adaptado individualmente a tus necesidades",
    feature_2: "ü•ó Recetas saludables para cada d√≠a",
    feature_3: "üõí Listas de compras autom√°ticas",
    feature_4: "‚è∞ Ahorra tiempo y esfuerzo",
    get_started: "Comienza gratis ahora",
    example_title: "As√≠ podr√≠a verse tu plan semanal",
    allergy_gluten: "Gluten",
    allergy_lactose: "Lactosa",
    add_custom_allergy: "Agregar",
    meal_mon: "Verduras salteadas", mon:"Lunes",
    meal_tue: "Ensalada de quinoa y aguacate", tue:"Martes",
    meal_wed: "Salm√≥n con batatas", wed:"Mi√©rcoles",
    meal_thu: "Pollo al curry con arroz", thu:"Jueves",
    meal_fri: "Pasta con verduras", fri:"Viernes",
    meal_sat: "Hamburguesa vegetariana", sat:"S√°bado",
    meal_sun: "Salteado asi√°tico", sun:"Domingo",
    trust_gdpr: "Cumple con GDPR",
    trust_email: "Correos electr√≥nicos seguros",
    trust_ai: "Con IA",
    trust_mobile: "Optimizado para m√≥viles",
    custom_allergy_placeholder: "Agrega tu propia alergia"
  },
  fr: {
    cookie_text: "Nous utilisons des cookies pour am√©liorer votre exp√©rience. En utilisant notre site, vous acceptez notre politique de cookies.",
    accept_cookies: "Accepter",
    nav_features: "Fonctionnalit√©s",
    nav_pricing: "Tarifs",
    nav_how: "Comment √ßa marche",
    hero_title: "La nutrition personnalis√©e n‚Äôa jamais √©t√© aussi facile",
    hero_subtitle: "Plans hebdomadaires et recettes pilot√©s par l‚ÄôIA",
    feature_1: "‚ú® Adapt√© √† vos besoins individuels",
    feature_2: "ü•ó Recettes saines pour chaque jour",
    feature_3: "üõí Listes de courses automatiques",
    feature_4: "‚è∞ Gain de temps et d‚Äôefforts",
    get_started: "Commencez gratuitement",
    example_title: "Voici √† quoi pourrait ressembler votre semaine",
    allergy_gluten: "Gluten",
    allergy_lactose: "Lactose",
    add_custom_allergy: "Ajouter",
    meal_mon: "Po√™l√©e de l√©gumes", mon:"Lundi",
    meal_tue: "Salade de quinoa √† l‚Äôavocat", tue:"Mardi",
    meal_wed: "Saumon aux patates douces", wed:"Mercredi",
    meal_thu: "Curry de poulet au riz", thu:"Jeudi",
    meal_fri: "P√¢tes aux l√©gumes", fri:"Vendredi",
    meal_sat: "Burger v√©g√©tarien", sat:"Samedi",
    meal_sun: "Wok asiatique", sun:"Dimanche",
    trust_gdpr: "Conforme RGPD",
    trust_email: "Emails s√©curis√©s",
    trust_ai: "Pilot√© par l‚ÄôIA",
    trust_mobile: "Optimis√© mobile",
    custom_allergy_placeholder: "Ajoutez votre allergie"
  }
};

let currentLanguage = "de";

// Automatische IP-basierte Sprachempfehlung (Geo-IP)
fetch("https://ipapi.co/json/")
  .then(response => response.json())
  .then(data => {
    const country = data.country_code;
    const map = { DE: "de", AT: "de", CH: "de", FR: "fr", ES: "es", GB: "en", US: "en" };
    if(map[country]) {
      switchLanguage(map[country]);
    }
  }).catch(() => switchLanguage("de"));

function switchLanguage(lang) {
  currentLanguage = lang;
  Object.keys(translations[lang]).forEach(key => {
    const el = document.getElementById(key);
    if (el) {
      if(key==="custom_allergy_placeholder") el.placeholder = translations[lang][key];
      else el.textContent = translations[lang][key];
    }
  });
  // Button-Highlight
  ["de","en","es","fr"].forEach(l => {
    let b = document.getElementById("lang_" + l);
    if(b) b.classList.toggle("active", l===lang);
  });
}

// Cookie-Banner
function acceptCookies() {
  document.getElementById('cookie-notice').style.display = "none";
}

// Questionnaire/Allergie
let selectedAllergies = [];
function toggleAllergy(allergy, event) {
  const button = event.target;
  if (selectedAllergies.includes(allergy)) {
    selectedAllergies = selectedAllergies.filter(a => a !== allergy);
    button.classList.remove('selected');
  } else {
    selectedAllergies.push(allergy);
    button.classList.add('selected');
  }
  updateAllergyDisplay();
}
function addCustomAllergy() {
  const input = document.getElementById('custom-allergy');
  const customAllergy = input.value.trim();
  if (customAllergy && !selectedAllergies.includes(customAllergy)) {
    selectedAllergies.push(customAllergy);
    input.value = '';
    updateAllergyDisplay();
  }
}
function updateAllergyDisplay() {
  const tagsContainer = document.getElementById('allergy-tags');
  const hiddenInput = document.getElementById('allergies-hidden');
  tagsContainer.innerHTML = selectedAllergies.map(allergy => `<span class="allergy-tag">${allergy}</span>`).join('');
  hiddenInput.value = selectedAllergies.join(', ');
}
function removeAllergy(allergy) {
  selectedAllergies = selectedAllergies.filter(a => a !== allergy);
  const button = document.querySelector(`[onclick="toggleAllergy('${allergy}', event)"]`);
  if (button) button.classList.remove('selected');
  updateAllergyDisplay();
}
// Chat Funktion
function toggleChat() {
  alert("KI-Chat Assistent - Bald verf√ºgbar!");
}

// Initialisieren √úbersetzung
document.addEventListener("DOMContentLoaded", function(){
  switchLanguage(currentLanguage);
});
